{
    "properties": {
        "displayName": "Audit use of classic virtual machines",
        "policyType": "BuiltIn",
        "mode": "All",
        "description": "Use new Azure Resource Manager v2 for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, ARM-based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management",
        "metadata": {
            "category": "Compute"
        },
        "parameters": { 
            "effect": {
                "type": "string",
                "defaultValue": "Audit",
                "allowedValues": ["Audit", "Disabled"],
                "metadata": {
                    "displayName": "Effect",
                    "description": "Enable or disable the execution of the policy"
                }
            } 
        },
        "policyRule": {
            "if": {
              "field": "type",
              "equals": "Microsoft.classicCompute/virtualMachines"
            },
            "then": {
              "effect": "[parameters('effect')]"
            }
        }
    },
    "id": "/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
    "name": "1d84d5fb-01f6-4d12-ba4f-4a26081d403d"
}
