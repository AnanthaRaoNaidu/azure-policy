{
  "id": "/providers/Microsoft.Authorization/policySetDefinitions/a169a624-5599-4385-a696-c8d643089fab",
  "name": "a169a624-5599-4385-a696-c8d643089fab",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Regulatory Compliance"
    },
    "parameters": {
      "WindowsFirewallDomainBehaviorForOutboundConnections": {
        "type": "string",
        "metadata": {
          "description": "Specifies the behavior for outbound connections for the Domain profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.",
          "displayName": "Windows Firewall (Domain): Behavior for outbound connections"
        },
        "defaultValue": "0"
      },
      "diskEncryptionMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring for VM disk encryption",
          "displayName": "Disk encryption should be applied on virtual machines"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "WindowsFirewallDomainAllowUnicastResponse": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Domain profile.",
          "displayName": "Windows Firewall: Domain: Allow unicast response"
        },
        "defaultValue": "0"
      },
      "vulnerabilityAssessmentOnManagedInstanceMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Audit SQL managed instances which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.",
          "displayName": "Vulnerability assessment should be enabled on your SQL managed instances"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "installedApplicationsOnWindowsVM": {
        "type": "string",
        "metadata": {
          "description": "A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')",
          "displayName": "Application names (supports wildcards)"
        }
      },
      "identityEnableMFAForOwnerPermissionsMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of MFA for accounts with owner permissions in subscription",
          "displayName": "MFA should be enabled on accounts with owner permissions on your subscription"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "disableUnrestrictedNetworkToStorageAccountMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of network access to storage account",
          "displayName": "Audit unrestricted network access to storage accounts"
        },
        "defaultValue": "Audit"
      },
      "DeployAzureBaselineSystemAuditPoliciesDetailedTrackingAuditProcessTermination": {
        "type": "string",
        "allowedValues": [
          "No Auditing",
          "Success",
          "Failure",
          "Success and Failure"
        ],
        "metadata": {
          "description": "Specifies whether audit events are generated when a process has exited. Recommended for monitoring termination of critical processes.",
          "displayName": "Audit Process Termination"
        },
        "defaultValue": "No Auditing"
      },
      "ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.",
          "displayName": "SQL managed instance TDE protector should be encrypted with your own key"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "WindowsFirewallPrivateDisplayNotifications": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Private profile.",
          "displayName": "Windows Firewall (Private): Display notifications"
        },
        "defaultValue": "1"
      },
      "diagnosticsLogsInSearchServiceRetentionDays": {
        "type": "string",
        "metadata": {
          "description": "The required diagnostic logs retention period in days",
          "displayName": "Required retention (in days) of logs in Azure Search service"
        },
        "defaultValue": "365"
      },
      "webAppDisableRemoteDebuggingMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of remote debugging for Web App",
          "displayName": "Remote debugging should be turned off for Web Application"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "DeployDiagnosticSettingsforNetworkSecurityGroupsstoragePrefix": {
        "type": "string",
        "metadata": {
          "description": "This prefix will be combined with the network security group location to form the created storage account name.",
          "displayName": "Storage Account Prefix for Regional Storage Account to deploy diagnostic settings for Network Security Groups"
        }
      },
      "classicComputeVMsMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of classic compute VMs",
          "displayName": "Virtual machines should be migrated to new Azure Resource Manager resources"
        },
        "defaultValue": "Audit"
      },
      "NetworkAccessSharesThatCanBeAccessedAnonymously": {
        "type": "string",
        "metadata": {
          "description": "Specifies which network shares can be accessed by anonymous users. The default configuration for this policy setting has little effect because all users have to be authenticated before they can access shared resources on the server.",
          "displayName": "Network access: Shares that can be accessed anonymously"
        },
        "defaultValue": "0"
      },
      "diagnosticsLogsInServiceFabricMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of diagnostic logs in Service Fabric",
          "displayName": "Diagnostic logs in Virtual Machine Scale Sets should be enabled"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "restrictAccessToManagementPortsMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of open management ports on Virtual Machines",
          "displayName": "Management ports should be closed on your virtual machines"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "WindowsFirewallDomainUseProfileSettings": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security uses the settings for the Domain profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.",
          "displayName": "Windows Firewall (Domain): Use profile settings"
        },
        "defaultValue": "1"
      },
      "jitNetworkAccessMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of network just In time access",
          "displayName": "Just-In-Time network access control should be applied on virtual machines"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits": {
        "type": "string",
        "metadata": {
          "description": "Audits if the system will shut down when unable to log Security events.",
          "displayName": "Audit: Shut down system immediately if unable to log security audits"
        },
        "defaultValue": "0"
      },
      "diagnosticsLogsInEventHubRetentionDays": {
        "type": "string",
        "metadata": {
          "description": "The required diagnostic logs retention period in days",
          "displayName": "Required retention (in days) of logs in Event Hub accounts"
        },
        "defaultValue": "365"
      },
      "WindowsFirewallPrivateApplyLocalConnectionSecurityRules": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Private profile.",
          "displayName": "Windows Firewall (Private): Apply local connection security rules"
        },
        "defaultValue": "1"
      },
      "WindowsFirewallPrivateApplyLocalFirewallRules": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Private profile.",
          "displayName": "Windows Firewall (Private): Apply local firewall rules"
        },
        "defaultValue": "1"
      },
      "EnableInsecureGuestLogons": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether the SMB client will allow insecure guest logons to an SMB server.",
          "displayName": "Enable insecure guest logons"
        },
        "defaultValue": "0"
      },
      "DeployDiagnosticSettingsforNetworkSecurityGroupsrgName": {
        "type": "string",
        "metadata": {
          "description": "The resource group that the storage account will be created in. This resource group must already exist.",
          "strongType": "ExistingResourceGroups",
          "displayName": "Resource Group Name for Storage Account (must exist) to deploy diagnostic settings for Network Security Groups"
        }
      },
      "WindowsFirewallPublicApplyLocalConnectionSecurityRules": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Public profile.",
          "displayName": "Windows Firewall (Public): Apply local connection security rules"
        },
        "defaultValue": "1"
      },
      "WindowsFirewallDomainApplyLocalConnectionSecurityRules": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Domain profile.",
          "displayName": "Windows Firewall (Domain): Apply local connection security rules"
        },
        "defaultValue": "1"
      },
      "NetworkAccessRemotelyAccessibleRegistryPaths": {
        "type": "string",
        "metadata": {
          "description": "Specifies which registry paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the `winreg` registry key.",
          "displayName": "Network access: Remotely accessible registry paths"
        },
        "defaultValue": "System\\CurrentControlSet\\Control\\ProductOptions|#|System\\CurrentControlSet\\Control\\Server Applications|#|Software\\Microsoft\\Windows NT\\CurrentVersion"
      },
      "WindowsFirewallPublicApplyLocalFirewallRules": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Public profile.",
          "displayName": "Windows Firewall (Public): Apply local firewall rules"
        },
        "defaultValue": "1"
      },
      "diagnosticsLogsInEventHubMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of diagnostic logs in Event Hub accounts",
          "displayName": "Diagnostic logs in Event Hub should be enabled"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "WindowsFirewallPublicDisplayNotifications": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Public profile.",
          "displayName": "Windows Firewall (Public): Display notifications"
        },
        "defaultValue": "1"
      },
      "systemUpdatesMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable reporting of system updates",
          "displayName": "System updates should be installed on your machines"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain": {
        "type": "string",
        "metadata": {
          "description": "Specify whether to prevent computers from connecting to both a domain based network and a non-domain based network at the same time. A value of 0 allows simultaneous connections, and a value of 1 blocks them.",
          "displayName": "Allow simultaneous connections to the Internet or a Windows Domain"
        },
        "defaultValue": "1"
      },
      "CertificateThumbprints": {
        "type": "string",
        "metadata": {
          "description": "A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\LocalMachine\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3",
          "displayName": "Certificate thumbprints"
        }
      },
      "nextGenerationFirewallMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable overly permissive inbound NSG rules monitoring",
          "displayName": "Access through Internet facing endpoint should be restricted"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "apiAppDisableRemoteDebuggingMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of remote debugging for API App",
          "displayName": "Remote debugging should be turned off for API App"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "diagnosticsLogsInBatchAccountRetentionDays": {
        "type": "string",
        "metadata": {
          "description": "The required diagnostic logs retention period in days",
          "displayName": "Required retention (in days) for logs in Batch accounts"
        },
        "defaultValue": "365"
      },
      "vulnerabilityAssesmentMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the detection of VM vulnerabilities by a vulnerability assessment solution",
          "displayName": "Vulnerabilities should be remediated by a Vulnerability Assessment solution"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.",
          "displayName": "SQL server TDE protector should be encrypted with your own key"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "kubernetesServiceRbacEnabledMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of Kubernetes Services without RBAC enabled",
          "displayName": "Role-Based Access Control (RBAC) should be used on Kubernetes Services"
        },
        "defaultValue": "Audit"
      },
      "identityEnableMFAForWritePermissionsMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of MFA for accounts with write permissions in subscription",
          "displayName": "MFA should be enabled accounts with write permissions on your subscription"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "WindowsFirewallPublicAllowUnicastResponse": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Public profile.",
          "displayName": "Windows Firewall: Public: Allow unicast response"
        },
        "defaultValue": "1"
      },
      "WindowsFirewallDomainDisplayNotifications": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Domain profile.",
          "displayName": "Windows Firewall (Domain): Display notifications"
        },
        "defaultValue": "1"
      },
      "WindowsFirewallPrivateAllowUnicastResponse": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Private profile.",
          "displayName": "Windows Firewall: Private: Allow unicast response"
        },
        "defaultValue": "0"
      },
      "adaptiveApplicationControlsMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of application whitelisting in Azure Security Center",
          "displayName": "Adaptive Application Controls should be enabled on virtual machines"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "DeployAzureBaselineSecurityOptionsAccountsAccountsGuestAccountStatus": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether the local Guest account is disabled.",
          "displayName": "Accounts: Guest account status"
        },
        "defaultValue": "0"
      },
      "WindowsFirewallPublicBehaviorForOutboundConnections": {
        "type": "string",
        "metadata": {
          "description": "Specifies the behavior for outbound connections for the Public profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.",
          "displayName": "Windows Firewall (Public): Behavior for outbound connections"
        },
        "defaultValue": "0"
      },
      "TurnOffMulticastNameResolution": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether LLMNR, a secondary name resolution protocol that transmits using multicast over a local subnet link on a single subnet, is enabled.",
          "displayName": "Turn off multicast name resolution"
        },
        "defaultValue": "1"
      },
      "WindowsFirewallDomainApplyLocalFirewallRules": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Domain profile.",
          "displayName": "Windows Firewall (Domain): Apply local firewall rules"
        },
        "defaultValue": "1"
      },
      "WindowsFirewallPrivateBehaviorForOutboundConnections": {
        "type": "string",
        "metadata": {
          "description": "Specifies the behavior for outbound connections for the Private profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.",
          "displayName": "Windows Firewall (Private): Behavior for outbound connections"
        },
        "defaultValue": "0"
      },
      "vmssOsVulnerabilitiesMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable virtual machine scale sets OS vulnerabilities monitoring",
          "displayName": "Vulnerabilities in security configuration on your virtual machine scale sets should be remediated"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "vmssSystemUpdatesMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable virtual machine scale sets reporting of system updates",
          "displayName": "System updates on virtual machine scale sets should be installed"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "apiAppEnforceHttpsMonitoringEffectV2": {
        "type": "string",
        "allowedValues": [
          "Audit",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of the use of HTTPS in API App V2",
          "displayName": "API App should only be accessible over HTTPS V2"
        },
        "defaultValue": "Audit"
      },
      "diagnosticsLogsInBatchAccountMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of diagnostic logs in Batch accounts",
          "displayName": "Diagnostic logs in Batch accounts should be enabled"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "WindowsFirewallPublicUseProfileSettings": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security uses the settings for the Public profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.",
          "displayName": "Windows Firewall (Public): Use profile settings"
        },
        "defaultValue": "1"
      },
      "diagnosticsLogsInSearchServiceMonitoringEffect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the monitoring of diagnostic logs in Azure Search service",
          "displayName": "Diagnostic logs in Search services should be enabled"
        },
        "defaultValue": "AuditIfNotExists"
      },
      "NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths": {
        "type": "string",
        "metadata": {
          "description": "Specifies which registry paths and sub-paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the `winreg` registry key.",
          "displayName": "Network access: Remotely accessible registry paths and sub-paths"
        },
        "defaultValue": "System\\CurrentControlSet\\Control\\Print\\Printers|#|System\\CurrentControlSet\\Services\\Eventlog|#|Software\\Microsoft\\OLAP Server|#|Software\\Microsoft\\Windows NT\\CurrentVersion\\Print|#|Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows|#|System\\CurrentControlSet\\Control\\ContentIndex|#|System\\CurrentControlSet\\Control\\Terminal Server|#|System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig|#|System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration|#|Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib|#|System\\CurrentControlSet\\Services\\SysmonLog"
      },
      "RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether to make the Recovery Console SET command available, which allows setting of recovery console environment variables.",
          "displayName": "Recovery console: Allow floppy copy and access to all drives and all folders"
        },
        "defaultValue": "0"
      },
      "WindowsFirewallPrivateUseProfileSettings": {
        "type": "string",
        "metadata": {
          "description": "Specifies whether Windows Firewall with Advanced Security uses the settings for the Private profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.",
          "displayName": "Windows Firewall (Private): Use profile settings"
        },
        "defaultValue": "1"
      }
    },
    "displayName": "Audit HITRUST/HIPAA controls and deploy specific VM Extensions to support audit requirements",
    "description": "This initiative includes policies that address a subset of HITRUST/HIPAA controls. Additional policies will be added in upcoming releases. https://aka.ms/hipaa-blueprint",
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "DeploydefaultMicrosoftIaaSAntimalwareextensionforWindowsServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "diagnosticsLogsInBatchAccountMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d",
        "parameters": {
          "requiredRetentionDays": {
            "value": "[parameters('diagnosticsLogsInBatchAccountRetentionDays')]"
          },
          "effect": {
            "value": "[parameters('diagnosticsLogsInBatchAccountMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "systemUpdatesMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
        "parameters": {
          "effect": {
            "value": "[parameters('systemUpdatesMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "RequireencryptiononDataLakeStoreaccounts",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260",
        "parameters": {
          "effect": {
            "value": "[parameters('ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "diskEncryptionMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
        "parameters": {
          "effect": {
            "value": "[parameters('diskEncryptionMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "AuditSQLTransparentDataEncryptionStatus",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_InstalledApp",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6",
        "parameters": {
          "installedApplication": {
            "value": "[parameters('installedApplicationsOnWindowsVM')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_InstalledApp",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SecurityOptionsAudit",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21e2995e-683e-497a-9e81-2f42ad07050a",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SecurityOptionsAudit",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/498b810c-59cd-4222-9338-352ba146ccf3",
        "parameters": {
          "AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits": {
            "value": "[parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SystemAuditPoliciesAccountManagement",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/225e937e-d32e-4713-ab74-13ce95b3519a",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SystemAuditPoliciesAccountManagement",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a9991e6-21be-49f9-8916-a06d934bcf29",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SystemAuditPoliciesDetailedTracking",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9a33475-481d-4b81-9116-0bf02ffe67e8",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SystemAuditPoliciesDetailedTracking",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/42a07bbf-ffcf-459a-b4b1-30ecd118a505",
        "parameters": {
          "AuditProcessTermination": {
            "value": "[parameters('DeployAzureBaselineSystemAuditPoliciesDetailedTrackingAuditProcessTermination')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "diagnosticsLogsInSearchServiceMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4",
        "parameters": {
          "requiredRetentionDays": {
            "value": "[parameters('diagnosticsLogsInSearchServiceRetentionDays')]"
          },
          "effect": {
            "value": "[parameters('diagnosticsLogsInSearchServiceMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "AuditVirtualMachinesWithoutDisasterRecoveryConfigured",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "vulnerabilityAssessmentOnManagedInstanceMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
        "parameters": {
          "effect": {
            "value": "[parameters('vulnerabilityAssessmentOnManagedInstanceMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "vulnerabilityAssessmentMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c",
        "parameters": {
          "effect": {
            "value": "[parameters('vulnerabilityAssesmentMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SecurityOptionsMicrosoftNetworkServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fe4ef56-7576-4dc4-8e9c-26bad4b087ce",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SecurityOptionsMicrosoftNetworkServer",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86880e5c-df35-43c5-95ad-7e120635775e",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_AdministrativeTemplatesNetwork",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7229bd6a-693d-478a-87f0-1dc1af06f3b8",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_AdministrativeTemplatesNetwork",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/985285b7-b97a-419c-8d48-c88cc934c8d8",
        "parameters": {
          "AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain": {
            "value": "[parameters('AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain')]"
          },
          "TurnOffMulticastNameResolution": {
            "value": "[parameters('TurnOffMulticastNameResolution')]"
          },
          "EnableInsecureGuestLogons": {
            "value": "[parameters('EnableInsecureGuestLogons')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Deploynetworkwatcherwhenvirtualnetworksarecreated",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_WindowsFirewallProperties",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8bbd627e-4d25-4906-9a6e-3789780af3ec",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_WindowsFirewallProperties",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/909c958d-1b99-4c74-b88f-46a5c5bc34f9",
        "parameters": {
          "WindowsFirewallDomainBehaviorForOutboundConnections": {
            "value": "[parameters('WindowsFirewallDomainBehaviorForOutboundConnections')]"
          },
          "WindowsFirewallDomainApplyLocalFirewallRules": {
            "value": "[parameters('WindowsFirewallDomainApplyLocalFirewallRules')]"
          },
          "WindowsFirewallPrivateAllowUnicastResponse": {
            "value": "[parameters('WindowsFirewallPrivateAllowUnicastResponse')]"
          },
          "WindowsFirewallPublicDisplayNotifications": {
            "value": "[parameters('WindowsFirewallPublicDisplayNotifications')]"
          },
          "WindowsFirewallDomainApplyLocalConnectionSecurityRules": {
            "value": "[parameters('WindowsFirewallDomainApplyLocalConnectionSecurityRules')]"
          },
          "WindowsFirewallPrivateUseProfileSettings": {
            "value": "[parameters('WindowsFirewallPrivateUseProfileSettings')]"
          },
          "WindowsFirewallPublicBehaviorForOutboundConnections": {
            "value": "[parameters('WindowsFirewallPublicBehaviorForOutboundConnections')]"
          },
          "WindowsFirewallDomainDisplayNotifications": {
            "value": "[parameters('WindowsFirewallDomainDisplayNotifications')]"
          },
          "WindowsFirewallPrivateBehaviorForOutboundConnections": {
            "value": "[parameters('WindowsFirewallPrivateBehaviorForOutboundConnections')]"
          },
          "WindowsFirewallPrivateDisplayNotifications": {
            "value": "[parameters('WindowsFirewallPrivateDisplayNotifications')]"
          },
          "WindowsFirewallDomainUseProfileSettings": {
            "value": "[parameters('WindowsFirewallDomainUseProfileSettings')]"
          },
          "WindowsFirewallPrivateApplyLocalFirewallRules": {
            "value": "[parameters('WindowsFirewallPrivateApplyLocalFirewallRules')]"
          },
          "WindowsFirewallPublicUseProfileSettings": {
            "value": "[parameters('WindowsFirewallPublicUseProfileSettings')]"
          },
          "WindowsFirewallPublicAllowUnicastResponse": {
            "value": "[parameters('WindowsFirewallPublicAllowUnicastResponse')]"
          },
          "WindowsFirewallPrivateApplyLocalConnectionSecurityRules": {
            "value": "[parameters('WindowsFirewallPrivateApplyLocalConnectionSecurityRules')]"
          },
          "WindowsFirewallPublicApplyLocalFirewallRules": {
            "value": "[parameters('WindowsFirewallPublicApplyLocalFirewallRules')]"
          },
          "WindowsFirewallPublicApplyLocalConnectionSecurityRules": {
            "value": "[parameters('WindowsFirewallPublicApplyLocalConnectionSecurityRules')]"
          },
          "WindowsFirewallDomainAllowUnicastResponse": {
            "value": "[parameters('WindowsFirewallDomainAllowUnicastResponse')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "nextGenerationFirewallMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
        "parameters": {
          "effect": {
            "value": "[parameters('nextGenerationFirewallMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "ensureServerTDEIsEncryptedWithYourOwnKeyMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
        "parameters": {
          "effect": {
            "value": "[parameters('ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "apiAppDisableRemoteDebuggingMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e",
        "parameters": {
          "effect": {
            "value": "[parameters('apiAppDisableRemoteDebuggingMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "classicComputeVMsMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
        "parameters": {
          "effect": {
            "value": "[parameters('classicComputeVMsMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "disableUnrestrictedNetworkToStorageAccountMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
        "parameters": {
          "effect": {
            "value": "[parameters('disableUnrestrictedNetworkToStorageAccountMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "adaptiveApplicationControlsMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc",
        "parameters": {
          "effect": {
            "value": "[parameters('adaptiveApplicationControlsMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "DeployDiagnosticSettingsforNetworkSecurityGroups",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89",
        "parameters": {
          "rgName": {
            "value": "[parameters('DeployDiagnosticSettingsforNetworkSecurityGroupsrgName')]"
          },
          "storagePrefix": {
            "value": "[parameters('DeployDiagnosticSettingsforNetworkSecurityGroupsstoragePrefix')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SecurityOptionsNetworkAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/30040dab-4e75-4456-8273-14b8f75d91d9",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SecurityOptionsNetworkAccess",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f56a3ab2-89d1-44de-ac0d-2ada5962e22a",
        "parameters": {
          "NetworkAccessSharesThatCanBeAccessedAnonymously": {
            "value": "[parameters('NetworkAccessSharesThatCanBeAccessedAnonymously')]"
          },
          "NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths": {
            "value": "[parameters('NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths')]"
          },
          "NetworkAccessRemotelyAccessibleRegistryPaths": {
            "value": "[parameters('NetworkAccessRemotelyAccessibleRegistryPaths')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "webAppDisableRemoteDebuggingMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
        "parameters": {
          "effect": {
            "value": "[parameters('webAppDisableRemoteDebuggingMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "PreviewAuditLinuxVMsThatDoNotHaveThePasswdFilePermissionsSetTo0644",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "PreviewDeployVMExtensionToAuditThatLinuxVMsHaveThePasswdFilePermissionsSeTTo0644",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "AuditSqlServerLevelAuditingSettings",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Audit_WindowsCertificateInTrustedRoot",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_WindowsCertificateInTrustedRoot",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5",
        "parameters": {
          "CertificateThumbprints": {
            "value": "[parameters('CertificateThumbprints')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "apiAppEnforceHttpsMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7ddfbdc-1260-477d-91fd-98bd9be789a6",
        "parameters": {
          "effect": {
            "value": "[parameters('apiAppEnforceHttpsMonitoringEffectV2')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "PreviewAuditWindowsVMsThatDoNotHaveThePasswordComplexitySettingEnabled",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "PreviewDeployVmExtensionToAuditWindowsVmEnforcesPasswordComplexityRequirements",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "identityEnableMFAForWritePermissionsMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
        "parameters": {
          "effect": {
            "value": "[parameters('identityEnableMFAForWritePermissionsMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "jitNetworkAccessMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
        "parameters": {
          "effect": {
            "value": "[parameters('jitNetworkAccessMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "identityEnableMFAForOwnerPermissionsMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
        "parameters": {
          "effect": {
            "value": "[parameters('identityEnableMFAForOwnerPermissionsMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "kubernetesServiceRbacEnabledMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
        "parameters": {
          "effect": {
            "value": "[parameters('kubernetesServiceRbacEnabledMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SecurityOptionsAccounts",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b872a447-cc6f-43b9-bccf-45703cd81607",
        "parameters": {}
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SecurityOptionsAccounts",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e5b81f87-9185-4224-bf00-9f505e9f89f3",
        "parameters": {
          "AccountsGuestAccountStatus": {
            "value": "[parameters('DeployAzureBaselineSecurityOptionsAccountsAccountsGuestAccountStatus')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "restrictAccessToManagementPortsMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
        "parameters": {
          "effect": {
            "value": "[parameters('restrictAccessToManagementPortsMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "vmssOsVulnerabilitiesMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4",
        "parameters": {
          "effect": {
            "value": "[parameters('vmssOsVulnerabilitiesMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "diagnosticsLogsInEventHubMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a",
        "parameters": {
          "requiredRetentionDays": {
            "value": "[parameters('diagnosticsLogsInEventHubRetentionDays')]"
          },
          "effect": {
            "value": "[parameters('diagnosticsLogsInEventHubMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "vmssSystemUpdatesMonitoring",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe",
        "parameters": {
          "effect": {
            "value": "[parameters('vmssSystemUpdatesMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "diagnosticsLogsInServiceFabricMonitoringEffect",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1",
        "parameters": {
          "effect": {
            "value": "[parameters('diagnosticsLogsInServiceFabricMonitoringEffect')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_AzureBaseline_SecurityOptionsRecoveryconsole",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba12366f-f9a6-42b8-9d98-157d0b1a837b"
      },
      {
        "policyDefinitionReferenceId": "Deploy_AzureBaseline_SecurityOptionsRecoveryconsole",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ddc0a4d5-5e08-43d5-9fd9-b586d8d7116b",
        "parameters": {
          "RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders": {
            "value": "[parameters('RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders')]"
          }
        }
      }
    ]
  }
}
