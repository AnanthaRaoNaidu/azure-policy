{
  "id": "/providers/Microsoft.Authorization/policySetDefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2",
  "name": "d7fff7ea-9d47-4952-b854-b7da261e48f2",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Guest Configuration"
    },
    "parameters": {
      "ApplicationName": {
        "type": "string",
        "metadata": {
          "description": "A semicolon-separated list of the names of the applications that should not be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')",
          "displayName": "Application names (supports wildcards)"
        }
      }
    },
    "displayName": "Audit Windows VMs that have the specified applications installed",
    "description": "This initiative deploys the policy requirements and audits Windows virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol",
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "Deploy_NotInstalledApp",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2",
        "parameters": {
          "ApplicationName": {
            "value": "[parameters('ApplicationName')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_NotInstalledApp",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c"
      }
    ]
  }
}
