{
  "id": "/providers/Microsoft.Authorization/policySetDefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e",
  "name": "c937dcb4-4398-4b39-8d63-4a6be432252e",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Guest Configuration"
    },
    "parameters": {
      "ApplicationName": {
        "type": "string",
        "metadata": {
          "description": "A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell'",
          "displayName": "Application names"
        }
      }
    },
    "displayName": "Audit Linux VMs that do not have the specified applications installed",
    "description": "This initiative deploys the policy requirements and audits Linux virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol",
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "Deploy_InstalledApplicationLinux",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721",
        "parameters": {
          "ApplicationName": {
            "value": "[parameters('ApplicationName')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_InstalledApplicationLinux",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004"
      }
    ]
  }
}
