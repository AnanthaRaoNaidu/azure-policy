{
  "id": "/providers/Microsoft.Authorization/policySetDefinitions/f000289c-47af-4043-87da-91ba9e1a2720",
  "name": "f000289c-47af-4043-87da-91ba9e1a2720",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Guest Configuration"
    },
    "parameters": {
      "ExecutionPolicy": {
        "type": "string",
        "allowedValues": [
          "AllSigned",
          "Bypass",
          "Default",
          "RemoteSigned",
          "Restricted",
          "Undefined",
          "Unrestricted"
        ],
        "metadata": {
          "description": "The expected PowerShell execution policy.",
          "displayName": "PowerShell Execution Policy"
        }
      }
    },
    "displayName": "Audit Windows VMs that do not have the specified Windows PowerShell execution policy",
    "description": "This initiative deploys the policy requirements and audits Windows virtual machines where Windows PowerShell is not configured to use the specified PowerShell execution policy. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol",
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "Deploy_WindowsPowerShellExecutionPolicy",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e0efc13a-122a-47c5-b817-2ccfe5d12615",
        "parameters": {
          "ExecutionPolicy": {
            "value": "[parameters('ExecutionPolicy')]"
          }
        }
      },
      {
        "policyDefinitionReferenceId": "Audit_WindowsPowerShellExecutionPolicy",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8036bd0-c10b-4931-86bb-94a878add855"
      }
    ]
  }
}
