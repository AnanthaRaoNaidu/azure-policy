{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d",
  "name": "0b15565f-aa9e-48ba-8619-45960f2c314d",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Security Center"
    },
    "parameters": {
      "effect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the execution of the policy",
          "displayName": "Effect"
        },
        "defaultValue": "AuditIfNotExists"
      }
    },
    "displayName": "Email notification to subscription owner for high severity alerts should be enabled",
    "policyRule": {
      "then": {
        "details": {
          "existenceCondition": {
            "field": "Microsoft.Security/securityContacts/alertsToAdmins",
            "notEquals": "Off"
          },
          "type": "Microsoft.Security/securityContacts"
        },
        "effect": "[parameters('effect')]"
      },
      "if": {
        "field": "type",
        "equals": "Microsoft.Resources/subscriptions"
      }
    },
    "description": "Enable emailing security alerts to the subscription owner, in order to have them receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion",
    "mode": "All"
  }
}
