{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
  "name": "6e2593d9-add6-4083-9c9b-4b7d2188c899",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Security Center"
    },
    "parameters": {
      "effect": {
        "type": "string",
        "allowedValues": [
          "AuditIfNotExists",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable the execution of the policy",
          "displayName": "Effect"
        },
        "defaultValue": "AuditIfNotExists"
      }
    },
    "displayName": "Email notification for high severity alerts should be enabled",
    "policyRule": {
      "then": {
        "details": {
          "existenceCondition": {
            "field": "Microsoft.Security/securityContacts/alertNotifications",
            "notEquals": "Off"
          },
          "type": "Microsoft.Security/securityContacts"
        },
        "effect": "[parameters('effect')]"
      },
      "if": {
        "field": "type",
        "equals": "Microsoft.Resources/subscriptions"
      }
    },
    "description": "Enable emailing security alerts to the security contact, in order to have them receive security alert emails from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risks",
    "mode": "All"
  }
}
