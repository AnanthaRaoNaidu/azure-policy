{
  "properties": {
    "displayName": "Private endpoint connections on Azure SQL Database should be enabled",
    "description": "When using private endpoints for Azure SQL Database, traffic is secured to a specific private link resource. The platform performs an access control to validate network connections reaching only the specified private link resource. This control provides an additional network security layer to your resources by providing a built-in exfiltration protection that prevents access to other resources hosted on the same Azure service.",
    "policyType": "BuiltIn",
    "mode": "Indexed",
    "metadata": {
      "version": "1.0.1",
      "category": "SQL"
    },
    "parameters": {},
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Sql/servers"
          },
          {
            "count": {
              "field": "Microsoft.Sql/servers/privateEndpointConnections[*]",
              "where": {
                "field": "Microsoft.Sql/servers/privateEndpointConnections[*].privateLinkServiceConnectionState.status",
                "equals": "Approved"
              }
            },
            "less": 1
          }
        ]
      },
      "then": {
        "effect": "audit"
      }
    }
  },
  "id": "/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed",
  "name": "7698e800-9299-47a6-b3b6-5a0fee576eed"
}
