{
  "id": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
  "name": "b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
  "properties": {
    "policyType": "BuiltIn",
    "metadata": {
      "version": "1.0.0",
      "category": "Network"
    },
    "parameters": {
      "listOfLocations": {
        "type": "Array",
        "metadata": {
          "description": "Audit if Network Watcher is not enabled for region(s).",
          "strongType": "location",
          "displayName": "Locations"
        }
      }
    },
    "displayName": "Network Watcher should be enabled",
    "policyRule": {
      "then": {
        "details": {
          "existenceCondition": {
            "field": "location",
            "in": "[parameters('listOfLocations')]"
          },
          "type": "Microsoft.Network/networkWatchers",
          "resourceGroupName": "NetworkWatcherRG"
        },
        "effect": "auditIfNotExists"
      },
      "if": {
        "field": "type",
        "equals": "Microsoft.Resources/subscriptions"
      }
    },
    "description": "Network Watcher is a regional service that enables you to monitor and diagnose conditions at a network scenario level in, to, and from Azure. Scenario level monitoring enables you to diagnose problems at an end to end network level view. Network diagnostic and visualization tools available with Network Watcher help you understand, diagnose, and gain insights to your network in Azure.",
    "mode": "All"
  }
}
